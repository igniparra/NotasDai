<html><head></head><body><dom-module id="my-view2"><template><style include="shared-styles">:host{display:block;padding:10px;}.dropdown{margin-left:20px;position:relative;left:25px;top:-10px;}.YesNoSign{margin-left:10px;}#conjuntoDeItems{background-color:#002984;color:white;}.acceptButton{background-color:#4caf50;color:White;padding:10px;margin:10px;margin-left:30px;}.cancelButton{background-color:#f44336;color:White;padding:10px;margin:10px;margin-left:30px;}</style><div class="card"><div class="layout horizontal layout-start"><h1>Proyecto de Auditoría</h1><firebase-document path="/proyectos" data="{{auditorias}}"></firebase-document><paper-dropdown-menu class="dropdown"><paper-listbox slot="dropdown-content" selected="{{auditoria}}" attr-for-selected="name"><dom-repeat items="{{_toArray(auditorias)}}"><template><paper-item name="{{item.val}}">{{item.val}}</paper-item></template></dom-repeat></paper-listbox></paper-dropdown-menu></div></div><firebase-document id="notasDocument" path="/notas" data="{{noteData}}"></firebase-document><template is="dom-repeat" items="[[_toArray(noteData)]]"><template is="dom-if" if="[[_isSelected(item.val.auditoria,auditoria,item.val.esNota)]]"><div class="card"><h3>Proyecto: [[item.val.auditoria]]</h3><h4>Destinatario: [[item.val.destinatario]]</h4><h4>Memo: [[item.val.memo]]</h4><template is="dom-repeat" items="[[_toArray(item.val)]]" as="nota"><div class="layout horizontal layout-start"><template is="dom-if" if="[[_isReiteracion(nota.key)]]">¿Es Reiteración?:<div hidden="[[!nota.val]]" class="YesNoSign">Si</div><div hidden="[[nota.val]]" class="YesNoSign">No</div></template></div><template is="dom-if" id="itemDomRepeat" if="[[_isItem(nota.key)]]"><template is="dom-repeat" items="[[_toArray(nota.val)]]" as="itemsDeNota" mutabledata=""><div class="card" id="conjuntoDeItems"><div class="layout horizontal layout-start">Descripción: [[itemsDeNota.val.desc]]<paper-button raised="" class="acceptButton" on-tap="_editNoteDialog" item="[[itemsDeNota.key]]" nota="[[item.key]]">Editar</paper-button></div></div></template></template></template><paper-button raised="" class="acceptButton" on-tap="_submitNoteDialog" nota="[[item.key]]">Enviar a Gerencia</paper-button><paper-button raised="" class="acceptButton" on-tap="_noteReceivedDialog" nota="[[item.key]]">Recibido en Organismo</paper-button><paper-button raised="" class="cancelButton" on-tap="_removeProject" nota="[[item.key]]">Remover Proyecto de Nota</paper-button></div></template></template><paper-dialog id="editDialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" style="width:300px;"><h2>Editar Item</h2><paper-dialog-scrollable><paper-textarea style="padding-left: 30px;padding-right: 30px;" id="input" label="Ingrese nueva descripción" value="{{editingItem}}"></paper-textarea></paper-dialog-scrollable><div class="buttons"><paper-fab dialog-confirm="" autofocus="" title="Guardar" icon="done" on-tap="_editNote" item$="[[editingItem]]" class="acceptButton"></paper-fab><paper-fab dialog-dismiss="" icon="cancel" class="cancelButton"></paper-fab></div></paper-dialog><paper-dialog id="aGerenciaDialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" style="width:300px;"><h2>Enviar a Gerencia</h2><paper-dialog-scrollable><paper-input style="padding-left: 30px;padding-right: 30px;" id="input" label="Ingrese número de memo" value="{{memo}}"></paper-input></paper-dialog-scrollable><div class="buttons"><paper-fab dialog-confirm="" autofocus="" title="Guardar" icon="done" on-tap="_submitNote" memo$="[[memo]]" class="acceptButton"></paper-fab><paper-fab dialog-dismiss="" icon="cancel" class="cancelButton"></paper-fab></div></paper-dialog><paper-dialog id="recibidoDialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" style="width:300px;"><h2>Recepción del auditado</h2><paper-dialog-scrollable><paper-input style="padding-left: 30px;padding-right: 30px;" id="input" label="Ingrese número de nota" value="{{nroNota}}"></paper-input><vaadin-date-picker id="receivedPicker" style="padding-left: 30px;padding-right: 30px;" label="Recibido" value="{{rcvDate}}"></vaadin-date-picker><vaadin-date-picker id="duePicker" style="padding-left: 30px;padding-right: 30px;" label="Vencimiento" value="{{dueDate}}"></vaadin-date-picker></paper-dialog-scrollable><div class="buttons"><paper-fab dialog-confirm="" autofocus="" title="Guardar" icon="done" on-tap="_noteReceived" nronota$="[[nroNota]]" rcvdate$="[[rcvDate]]" duedate$="[[dueDate]]" class="acceptButton"></paper-fab><paper-fab dialog-dismiss="" icon="cancel" class="cancelButton"></paper-fab></div></paper-dialog></template><script>class MyView2 extends Polymer.Element{static get is(){return"my-view2"}static get properties(){return{auditoria:{type:String,notify:!0},auditorias:Array,noteData:Array,currentNoteID:String,currentItemID:String,editingItem:{type:String,notify:!0},memo:String,nroNota:String,rcvDate:Date,dueDate:Date}}_toArray(a,b){var c=[];for(var d in a)(b||a.hasOwnProperty(d))&&c.push({key:d,val:a[d]});return c}_isItem(a){return"items"===a}_isProjectID(a){return"auditoria"===a}_isReiteracion(a){return"reiterado"===a}_isSelected(a,b,c){return a===b&&!c}_editNoteDialog(a){var b=a.model.itemsDeNota.key,c=a.model.item.key;this.currentItemID=b,this.currentNoteID=c,this.$.editDialog.open()}_submitNoteDialog(a){var b=a.model.item.key;this.currentNoteID=b,this.$.aGerenciaDialog.open()}_noteReceivedDialog(a){var b=a.model.item.key;this.currentNoteID=b,this.$.recibidoDialog.open()}_editNote(a){var b=a.target.getAttribute("item"),c=this.currentNoteID,d=this.currentItemID;this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/items/"+this.currentItemID+"/desc",b),this.$.itemsRepeat.render()}_submitNote(a){var b=a.target.getAttribute("memo");console.log(b);this.currentNoteID;this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/memo",b)}_noteReceived(a){var b=a.target.getAttribute("nroNota"),c=a.target.getAttribute("rcvDate"),d=a.target.getAttribute("dueDate"),e=this.currentNoteID;console.log("nroNota: "+b+" rcvDate: "+c+" dueDate: "+d),this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/idNota",b),this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/fechaRecibido",c),this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/vencimiento",d),this.$.notasDocument.setStoredValue("notas/"+this.currentNoteID+"/esNota",!0)}}window.customElements.define(MyView2.is,MyView2);</script></dom-module></body></html>